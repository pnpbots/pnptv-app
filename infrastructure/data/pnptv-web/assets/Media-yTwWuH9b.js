import{j as e,S as k,g as E,B as C,C as b,s as M,a as P}from"./index-Cn0k-BHZ.js";import{r as a}from"./vendor-DD6IjSBT.js";import{B}from"./Badge-BXfN9DIO.js";import"./auth-BkcVUzVN.js";function T({src:n,title:x,artist:r,cover:f,type:v="audio"}){const c=a.useRef(null),[u,l]=a.useState(!1),[h,m]=a.useState(0),[i,y]=a.useState(0),[p,N]=a.useState(!0);a.useEffect(()=>{const s=c.current;if(!s)return;const o=()=>m(s.currentTime),d=()=>y(s.duration||0),g=()=>N(!1),w=()=>l(!1);return s.addEventListener("timeupdate",o),s.addEventListener("durationchange",d),s.addEventListener("canplay",g),s.addEventListener("ended",w),()=>{s.removeEventListener("timeupdate",o),s.removeEventListener("durationchange",d),s.removeEventListener("canplay",g),s.removeEventListener("ended",w)}},[n]);const j=()=>{const s=c.current;s&&(u?s.pause():s.play(),l(!u))},S=s=>{const o=c.current;if(!o||!i)return;const d=s.currentTarget.getBoundingClientRect(),g=(s.clientX-d.left)/d.width;o.currentTime=g*i},t=s=>{const o=Math.floor(s/60),d=Math.floor(s%60);return`${o}:${d.toString().padStart(2,"0")}`};return p&&!n?e.jsx(k,{className:"h-20 w-full rounded-xl"}):e.jsxs("div",{className:"bg-pnp-surface rounded-xl border border-pnp-border p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[f&&e.jsx("img",{src:f,alt:x,className:"w-14 h-14 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[x&&e.jsx("p",{className:"font-medium text-pnp-textPrimary truncate",children:x}),r&&e.jsx("p",{className:"text-sm text-pnp-textSecondary truncate",children:r})]}),e.jsx("button",{onClick:j,className:"w-10 h-10 rounded-full bg-pnp-accent flex items-center justify-center text-pnp-background hover:bg-pnp-accentHover transition-colors",children:u?e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):e.jsx("svg",{className:"w-5 h-5 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-pnp-textSecondary",children:[e.jsx("span",{children:t(h)}),e.jsx("div",{className:"flex-1 h-1.5 bg-pnp-border rounded-full cursor-pointer",onClick:S,children:e.jsx("div",{className:"h-full bg-pnp-accent rounded-full transition-all",style:{width:i?`${h/i*100}%`:"0%"}})}),e.jsx("span",{children:t(i)})]}),v==="audio"?e.jsx("audio",{ref:c,src:n,preload:"metadata"}):e.jsx("video",{ref:c,src:n,preload:"metadata",className:"hidden"})]})}function L(n){return typeof n=="string"?n:(n==null?void 0:n.name)||""}function U(){const[n,x]=a.useState([]),[r,f]=a.useState(null),[v,c]=a.useState(null),[u,l]=a.useState(!0),[h,m]=a.useState(null),[i,y]=a.useState("library"),[p,N]=a.useState("");a.useEffect(()=>{l(!0),m(null),E(0,20).then(t=>x(t.tracks||[])).catch(t=>m(t.message)).finally(()=>l(!1))},[]);const j=()=>{p.trim()&&(l(!0),m(null),M(p,20).then(t=>{x(t.tracks||[]),y("search")}).catch(t=>m(t.message)).finally(()=>l(!1)))},S=async t=>{f(t);try{const s=await P(t.id);c(s.url)}catch{c(t.url)}};return e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-pnp-textPrimary",children:"PRIME"}),e.jsx("p",{className:"text-sm text-pnp-textSecondary mt-1",children:"Stream music, podcasts, and video content"})]}),e.jsx(B,{variant:"accent",children:"Ampache"})]}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",placeholder:"Search tracks, artists, albums...",value:p,onChange:t=>N(t.target.value),onKeyDown:t=>t.key==="Enter"&&j(),className:"flex-1 rounded-lg bg-pnp-surface border border-pnp-border px-4 py-2.5 text-sm text-pnp-textPrimary placeholder-pnp-textSecondary focus:outline-none focus:ring-2 focus:ring-pnp-accent focus:border-transparent"}),e.jsx(C,{onClick:j,size:"md",children:"Search"})]}),r&&e.jsx("div",{className:"mb-6",children:e.jsx(T,{src:v||r.url,title:r.title,artist:L(r.artist),cover:r.art})}),u?e.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((t,s)=>e.jsx(k,{className:"h-16 rounded-xl"},s))}):h?e.jsxs(b,{className:"text-center py-8",children:[e.jsx("p",{className:"text-pnp-error mb-2",children:h}),e.jsx("p",{className:"text-sm text-pnp-textSecondary",children:"Media service is temporarily unavailable. Please try again later."})]}):n.length===0?e.jsxs(b,{className:"text-center py-8",children:[e.jsx("svg",{className:"w-12 h-12 text-pnp-textSecondary mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2z"})}),e.jsx("p",{className:"text-pnp-textSecondary",children:"No tracks found"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-sm font-medium text-pnp-textSecondary uppercase tracking-wider",children:i==="search"?`Results for "${p}"`:"Latest Tracks"}),e.jsxs("span",{className:"text-xs text-pnp-textSecondary",children:[n.length," tracks"]})]}),n.map(t=>e.jsx(b,{onClick:()=>S(t),hover:!0,className:(r==null?void 0:r.id)===t.id?"border-pnp-accent":"",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.art?e.jsx("img",{src:t.art,alt:t.title,className:"w-10 h-10 rounded object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded bg-pnp-accent/10 flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-pnp-accent",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-pnp-textPrimary truncate",children:t.title}),e.jsx("p",{className:"text-sm text-pnp-textSecondary truncate",children:L(t.artist)})]}),e.jsxs("span",{className:"text-xs text-pnp-textSecondary",children:[Math.floor(t.time/60),":",(t.time%60).toString().padStart(2,"0")]})]})},t.id))]})]})}export{U as default};
